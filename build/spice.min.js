/*! spice 2013-09-05 */
window.$spice=function(a){function b(a,b){return a.close=function(){return b},a}function c(a,b){function c(c){return function(){return $spice.fn[c].call(a,a,b.data(),b.index())}}for(var d in $spice.fn)$spice.fn.hasOwnProperty(d)&&$spice.fn[d]&&(a[d]=c(d))}var d=function(d){var j={};return j.data=function(a){return arguments.length?(d.data(a),j):d.data()},j.eval=function(a){return"function"==typeof a?a.call(d.result(),d.data(),d.index()):a},j.call=function(a){return a.call(d.result(),d.data(),d.index()),j},j.append=function(a){return d.push(a),j},j.open=function(a){var c=g(a,d.data(),d.index()),e=h(c);return j.append(a),b(e,j)},j.each=function(c){var k,l;return c=j.eval(c),k=c.map(function(b,c){var i=d.result();return a.isArray(i)?f(e(i,b,c)):h(g(i,b,c))}),l=i(k,d),b(l,j)},j._if=function(a){var c=l(j.eval(a),j,d);return b(c,j)},c(j,d),j},e=function(b,c,d){var e={};return b=b||[],e.data=function(a){return arguments.length?(c=a,e):c},e.index=function(){return d},e.select=function(c){return b.reduce(function(a,b){return a.add(b.find(c))},a())},e.selectAll=e.select,e.push=function(a){b.push(a)},e.result=function(){return b},e.methods={},e},f=function(a){var c=d(a);return c.select=function(d){var f=a.select(d),j=f.map(function(b,c){var d=g(c,a.data(),b);return h(d)}),k=f[0]?g(f[0],a.data(),a.index()):e(),l=i(j,k);return b(l,c)},c.close=function(){return a.result()},c},g=function(b,c,d){var e={},f=[],g=a(b);return e.data=function(a){return arguments.length?(c=a,e):c},e.index=function(){return d},e.select=function(b){return f.reduce(function(c,d){return c.add(a(d).find(b))},a())},e.selectAll=function(a){return g.find(a)},e.push=function(a){f.push(a),g.append(a)},e.result=function(){return b},e.methods={text:function(a){g.append(a)},attr:function(a,b){g.attr(a,b)},attrs:function(a){g.attr(a)},classed:function(a){for(var b in a)a.hasOwnProperty(b)&&a[b]&&g.addClass(b)}},e},h=function(a){var c=d(a);return c.select=function(d){var f=a.select(d),j=f.map(function(b,c){var d=g(c,a.data(),a.index());return h(d)}).get(),k=f[0]?g(f[0],a.data(),a.index()):e(),l=i(j,k);return b(l,c)},c.text=function(b){return b=c.eval(b),a.methods.text(b),c},c.attr=function(b,d){return d=c.eval(d),a.methods.attr(b,d),c},c.attrs=function(b){return b=c.eval(b),a.methods.attrs(b),c},c.classed=function(b){return b=c.eval(b),a.methods.classed(b),c},c},i=function(d,f){function h(a){return function(){var b=arguments;return d.forEach(function(c){c[a].apply(c,b)}),k}}function j(a){return function(){var c=arguments,e=d.map(function(b){return b[a].apply(b,c)}),g=i(e,f);return b(g,k)}}var k={};k.select=function(a){var c=d.map(function(b){return b.select(a)}),h=f.selectAll(a),j=h[0]?g(h[0],f.data(),f.index()):e(),l=i(c,j);return b(l,k)},k.open=function(c){var e=d.map(function(b){var d=a(c).clone()[0];return b.open(d)}),h=g(c,f.data(),f.index()),j=i(e,h);return b(j,k)};var l=["each","_if"];l.forEach(function(a){k[a]=j(a)});var m=["call","append"];m.forEach(function(a){k[a]=h(a)});for(var n in f.methods)f.methods.hasOwnProperty(n)&&(k[n]=h(n));return c(k,f),k},j=function(a){return i([],a)},k=function(a,c){var d={},e=["select","each","open","append"];e.forEach(function(c){d[c]=function(){var e=a[c].apply(a,arguments);return b(e,d)}});var f=["data","call"];return f.forEach(function(b){d[b]=function(){return a[b].apply(a,arguments),d}}),d.eval=function(){return a.eval.apply(a,arguments)},d._if=function(a){var e=l(d.eval(a),d,c);return b(e,d)},d},l=function(a,d,e){var f=a?k(d,e):j(e),g=a?j(e):k(d,e);return c(f,e),c(g,e),f._else=function(){return b(g,d)},f};return $spice=function(a){return a?f(g(a)):f(e())},$spice.select=function(b){var c=a(b)[0];return f(g(c))},$spice.fn={},$spice}(window.$);