/*! spice 2013-08-30 */
window.$spice=function(a){function b(a,b){return a.close=function(){return b},a}function c(b){function c(c){return function(){var d=a("<"+c+">");return b.open(d)}}var d=["h1","h2","h3","h4","h5","h6","p","div","span","ul","ol","li"];return d.forEach(function(a){b[a]=c(a)}),b}function d(a,b){for(var c in $spice.fn)$spice.fn.hasOwnProperty(c)&&$spice.fn[c]&&(a[c]=function(){return $spice.fn[c].call(a,a,b.data(),b.index())})}var e=function(a){var c={};return c.data=function(b){return arguments.length?(a.data(b),c):a.data()},c.eval=function(b){return"function"==typeof b?b.call(a.result(),a.data(),a.index()):b},c.call=function(b){return b.call(a.result(),a.data(),a.index()),c},c.open=function(d){var e=h(d,a.data(),a.index()),f=i(e);return a.push(d),b(f,c)},c.each=function(d){var e,f;return d=c.eval(d),e=d.map(function(b,c){var d=h(a.result(),b,c);return i(d)}),f=j(e,a),b(f,c)},c._if=function(d){var e=m(c.eval(d),c,a);return b(e,c)},c},f=function(){var b={},c=[];return b.data=function(){return arguments.length?b:null},b.index=function(){return null},b.select=function(b){return c.reduce(function(a,c){return a.add(c.find(b))},a())},b.selectAll=b.select,b.push=function(a){c.push(a)},b.result=function(){return c},b.methods={},b},g=function(a){var g=e(a);return g.select=function(c){var d=a.select(c),e=d.map(function(b,c){var d=h(c,a.data(),b);return i(d)}),k=d[0]?h(d[0],a.data(),a.index()):f(),l=j(e,k);return b(l,g)},g.close=function(){return a.result()},d(g,a),c(g),g},h=function(b,c,d){var e={},f=[];return e.data=function(a){return arguments.length?(c=a,e):c},e.index=function(){return d},e.select=function(b){return f.reduce(function(a,c){return a.add(c.find(b))},a())},e.selectAll=function(a){return b.find(a)},e.push=function(a){f.push(a),b.append(a)},e.result=function(){return b},e.methods={text:function(a){b.append(a)},attr:function(a,c){b.attr(a,c)},attrs:function(a){b.attr(a)},classed:function(a){for(var c in a)a.hasOwnProperty(c)&&a[c]&&b.addClass(c)}},e},i=function(g){var k=e(g);return k.select=function(c){var d=g.select(c),e=d.map(function(b,c){var d=h(a(c),g.data(),g.index());return i(d)}).get(),l=d[0]?h(a(d[0]),g.data(),g.index()):f(),m=j(e,l);return b(m,k)},d(k,g),c(k),k.text=function(a){return a=k.eval(a),g.methods.text(a),k},k.attr=function(a,b){return b=k.eval(b),g.methods.attr(a,b),k},k.attrs=function(a){return a=k.eval(a),g.methods.attrs(a),k},k.classed=function(a){return a=k.eval(a),g.methods.classed(a),k},k},j=function(e,g){function i(a){return function(){var b=arguments;return e.forEach(function(c){c[a].apply(c,b)}),l}}function k(a){return function(){var c=arguments,d=e.map(function(b){return b[a].apply(b,c)}),f=j(d,g);return b(f,l)}}var l={};l.select=function(c){var d=e.map(function(a){return a.select(c)}),i=g.selectAll(c),k=i[0]?h(a(i[0]),g.data(),g.index()):f(),m=j(d,k);return b(m,l)},l.open=function(a){var c=e.map(function(b){return b.open(a.clone())}),d=h(a,g.data(),g.index()),f=j(c,d);return b(f,l)};var m=["each","_if"];m.forEach(function(a){l[a]=k(a)});var n=["call"];n.forEach(function(a){l[a]=i(a)});for(var o in g.methods)g.methods.hasOwnProperty(o)&&(l[o]=i(o));return d(l,g),c(l),l},k=function(a){return j([],a)},l=function(a){var c={},d=["select","each","_if","open"];d.forEach(function(d){c[d]=function(){var e=a[d].apply(a,arguments);return b(e,c)}});var e=["data","call"];return e.forEach(function(b){c[b]=function(){return a[b].apply(a,arguments),c}}),c},m=function(a,e,f){var g=a?l(e):k(f),h=a?k(f):l(e);return c(g),d(g,f),c(h),d(h,f),g._else=function(){return b(h,e)},g};return $spice=function(){return g(f())},$spice.select=function(b){var c=a(b);return g(h(c))},$spice.fn={},$spice}(window.$);