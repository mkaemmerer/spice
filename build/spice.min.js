/*! spice 2013-10-11 */
window.$spice=function(a){function b(a,b){function c(c){return function(){var d=[].slice.call(arguments),e=[a,b.data(),b.index()];return c.apply(a,e.concat(d))}}function d(c){return function(){var d=[].slice.call(arguments),e=[a,b.data(),b.index()];return c.apply(a,e.concat(d)),a}}for(var e in $spice.tags)$spice.tags.hasOwnProperty(e)&&$spice.tags[e]&&(a[e]=c($spice.tags[e]));for(var e in $spice.modifiers)$spice.modifiers.hasOwnProperty(e)&&$spice.modifiers[e]&&(a[e]=d($spice.modifiers[e]))}var c=function(c){var i={};return i.data=function(a){return arguments.length?(c.data(a),i):c.data()},i.call=function(a){return a.call(c.result(),c.data(),c.index()),i},i.eval=function(a){return"function"==typeof a?a(c.data(),c.index()):a},i.tap=function(a){return a(i),i},i.append=function(a){return c.push(a),i},i.open=function(a){var b=f(a,c.data(),c.index()),d=g(b);return i.append(a),d.bindClose(i)},i.selectAll=function(a){var b=c.select(a),d=b.map(function(a,b){return g(f(a,c.data(),b))}),e=h(d,f(null,c.data()));return e.bindClose(i)},i.each=function(b){var j,k;return b=i.eval(b),j=b.map(function(b,h){var i=c.result();return a.isArray(i)?e(d(i,b,h)):g(f(i,b,h))}),k=h(j,c),k.bindClose(i)},i._if=function(a){var b=k(i.eval(a),i,c);return b.bindClose(i)},b(i,c),i},d=function(b,c,d){var e={};return b=b||[],e.data=function(a){return arguments.length?(c=a,e):c},e.index=function(){return d},e.push=function(a){b.push(a)},e.result=function(){return b},e.select=function(c){var d=b.map(function(b){return a(b).find(c).toArray()});return d.reduce(function(a,b){return a.concat(b)},[])},e.methods={},e},e=function(a){var b=c(a);return b.close=function(){return a.result()},b},f=function(b,c,d){var e={},f=[],g=a(b);return e.data=function(a){return arguments.length?(c=a,e):c},e.index=function(){return d},e.push=function(a){f.push(a),g.append(a)},e.result=function(){return b},e.select=function(a){return g.find(a).toArray()},e.methods={text:function(a){g.append(a)},attr:function(a,b){g.attr(a,b)},attrs:function(a){g.attr(a)},classed:function(a){for(var b in a)a.hasOwnProperty(b)&&a[b]&&g.addClass(b)}},e},g=function(a){var b,d=c(a);return d.bindClose=function(a){return b=a,d},d.close=function(){return b},d.text=function(b){return b=d.eval(b),a.methods.text(b),d},d.attr=function(b,c){return c=d.eval(c),a.methods.attr(b,c),d},d.attrs=function(b){return b=d.eval(b),a.methods.attrs(b),d},d.classed=function(b){return b=d.eval(b),a.methods.classed(b),d},d},h=function(b,c){function d(a){return function(){var c=arguments;return b.forEach(function(b){b[a].apply(b,c)}),j}}function e(a){return function(){var d=arguments,e=b.map(function(b){return b[a].apply(b,d)}),f=h(e,c);return f.bindClose(j)}}function g(a){return function(){var b=[].slice.call(arguments),d=[j,c.data(),c.index()];return a.apply(j,d.concat(b))}}var i,j={};j.selectAll=function(a){var d=b.map(function(b){return b.selectAll(a)}),e=f(null,c.data(),c.index()),g=h(d,e);return g},j.eval=function(a){return"function"==typeof a?a(c.data(),c.index()):a},j.tap=function(a){return a(j),j},j.open=function(d){var e=b.map(function(b){var c=a(d).clone()[0];return b.open(c)}),g=f(d,c.data(),c.index()),i=h(e,g);return i.bindClose(j)},j.bindClose=function(a){return i=a,j},j.close=function(){return i};var k=["each","_if"];k.forEach(function(a){j[a]=e(a)});var l=["call","append"];l.forEach(function(a){j[a]=d(a)});for(var m in c.methods)c.methods.hasOwnProperty(m)&&(j[m]=d(m));for(var m in $spice.modifiers)$spice.modifiers.hasOwnProperty(m)&&$spice.modifiers[m]&&(j[m]=d(m));for(var m in $spice.tags)$spice.tags.hasOwnProperty(m)&&$spice.tags[m]&&(j[m]=g($spice.tags[m]));return j},i=function(a){return h([],a)},j=function(a,b){var c,d={},e=["each","open","append"];e.forEach(function(b){d[b]=function(){var c=a[b].apply(a,arguments);return c.bindClose(d)}});var f=["data","call"];return f.forEach(function(b){d[b]=function(){return a[b].apply(a,arguments),d}}),d.bindClose=function(a){return c=a,d},d.close=function(){return c},d.eval=function(a){return"function"==typeof a?a(b.data(),b.index()):a},d.tap=function(a){return a(d),d},d._if=function(a){var c=k(d.eval(a),d,b);return c.bindClose(d)},d},k=function(a,c,d){var e=a?j(c,d):i(d),f=a?i(d):j(c,d);return b(e,d),b(f,d),e._else=function(){return f.bindClose(c)},e.bindClose(c)};return $spice=function(a){return a?g(f(a)):e(d())},$spice.select=function(b){var c=a(b)[0];return e(f(c))},$spice.tags={},$spice.modifiers={},$spice}(window.$);